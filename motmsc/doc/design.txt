
major processing steps

  rdr2mat    - wrapper for the MIT reader
  movavg_pre - moving averages preprocessor
  rdr2sdr    - main function for RDR to SDR processing

a family of proposed procedures for output processing

  sdr2rtp    - save SDRs as RTP files
  sdr2netcdf - save SDRs as netcdf files
  sdr2map    - tile SDRs for fancy maps, data QC, etc.

For example sdr2rtp would
 
  - load the SDR data
  - read any metadata needed from the hdf rdr file
  - do geolocation (calculated or maybe from GCRSO* files)
  - do time matching for sci, eng, geo (if from a file), meta data,
    and things like stats flags
  - loop on spectral data in time order and write the RTP files

sdr2netcdf would be similar but might also do tiling, depending on
how you want to organize the netcdf data.

These procedures communicate thru files

  RDR_<rid>.mat  -- RDR mat files, from rdr2mat
  avg_<rid>.mat  -- moving average files, from movavg_pre
  SDR_<rid>.mat  -- SDR mat files, from this rdr2sdr

where <rid> is a string of the form tYYYYMMDD_dHHMMSSS taken from
the RDR HDF5 file.  What goes into the SDR mat files is whatever we
want--all the things we discussed that might be useful for the RTP
files, for starters.

For now the sdr2rtp stuff is just an outline.  I need a usable
version of rdr2sdr, the main function for RDR to SDR processing,
before we can do anything else.


old design overview for the RDR to SDR processing  
--------------------------------------------------

Preliminary

  run MIT reader on RDR HDF files
  (probably an entirely separate process)

  specify a path and list of RDR mat files

  set any structure and/or file parameters


Loop on RDR mat files (moving average loop)

  calculate moving averages with a 3-file moving window, details
  are similar to (1-5) below (movavg_pre.m)


Loop on RDR mat files (main loop)

  (1) load a 60-scan matlab RDR file
  
  (2) organize the data as nchan x 9 x nobs arrays, in column and
      time order, and do some validation checks (checkRDRf.m)

  (3) read and process sci and eng data, get ICT temps and 
      current met laser value (scipack.m)

  (4) translate the RDR pseudo-interferograms to count spectra
      (ifg2spectra.m/readspec6.m)

  (5) organize the data into scans, as nchan x 9 x 34 x nscan arrays,
      and do some more validation checks (scanorder.m)

  (6) if available load file-spanning calibration averages, else
      calculate single-file moving averages (movavg_app.m)

  (7) non-linearity correction (calmain2.m)

  (8) self apodization correction (selfApodCorr.m)

  (9) radiometric calibration (radcal.m)

  (10) resample to user wavenumber grid and resolution
       (applyResampling.m)

  (11) save calibrated SDR data as mat files


Loop on SDR mat files (archival loop)

  (1) do geolocation
  
  (2) for netCDF or HDF archives, reshape data so files always
      begins with ES 1.  This needs at least a 2-file moving window

  (3) save SDR files in archival format (netCDF, HDF, or RTP files)

